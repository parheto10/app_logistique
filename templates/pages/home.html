{% extends 'base.html' %}
{% load static %}
{% block breadcumbs %}
    <div class="page-breadcrumb">
          <div class="row">
            <div class="col-12 d-flex no-block align-items-center">
              <h4 class="page-title">Dashboard</h4>
            </div>
          </div>
        </div>
{% endblock %}

{% block content %}
    <div class="row">
            <!-- Column -->
            <!-- Column -->
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-success text-center">
                  <h1 class="font-light text-white">
                    {{nb_mission_en_cours}}
                  </h1>
                  <h6 class="text-white">Mission en cours</h6>
                </div>
              </div>
            </div>   
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-success text-center">
                  <h1 class="font-light text-white">
                    {{nb_vehicule_disponible}}
                  </h1>
                  <h6 class="text-white">Voiture disponibles</h6>
                </div>
              </div>
            </div> 
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-success text-center">
                  <h1 class="font-light text-white">
                   {{nb_moto_disponible}}
                  </h1>
                  <h6 class="text-white">Motos & Tricycles disponibles</h6>
                </div>
              </div>
            </div>
            <!-- Column -->
       
            <!-- Column -->
            <!-- Column -->
            <!-- Column -->
            <!-- Column -->
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-danger text-center">
                  <h1 class="font-light text-white">
                    {{nb_voiture_garage}}
                  </h1>
                  <h6 class="text-white">Voiture occupées</h6>
                </div>
              </div>
            </div>   
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-danger text-center">
                  <h1 class="font-light text-white">
                    {{nb_moto_garage}}
                  </h1>
                  <h6 class="text-white">Motos occupées</h6>
                </div>
              </div>
            </div>
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-danger text-center">
                  <h1 class="font-light text-white">
                    {{nb_tois_roue_garage}}
                  </h1>
                  <h6 class="text-white">Tricycles occupés</h6>
                </div>
              </div>
            </div>
            <!-- Column -->
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-info text-center">
                  <h1 class="font-light text-white">
                   {{nb_employe_activite}}
                  </h1>
                  <h6 class="text-white">Total employés</h6>
                </div>
              </div>
            </div>
            <!-- Column -->
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-cyan text-center">
                  <h1 class="font-light text-white">
                   {{nb_projet_en_cours}}
                  </h1>
                  <h6 class="text-white">Projet en cours</h6>
                </div>
              </div>
            </div>
            <!-- Column -->
            <div class="col-md-6 col-lg-4 col-xlg-3">
              <div class="card card-hover">
                <div class="box bg-success text-center">
                  <h1 class="font-light text-white">
                    {{nb_equipement_ordi_fonctionnelle}}
                  </h1>
                  <h6 class="text-white">ORDINATEURS</h6>
                </div>
              </div>
            </div>
            <!-- Column -->
            
            <!-- Column -->
          </div>
    <div class="row">
        <div class="col-lg-6">
            <div class="card">
            <div class="card-body">
              <h4 class="card-title">Disponibilité Véhicule</h4>
                 <div class="table-responsive">
               <table id="zero_config" class="table table-striped table-bordered">
                 <thead>
                   <tr style="text-align: center">
                     <th>MATRICULE</th>
                     <th >ETAT</th>
                     <th >COULEUR</th>
                     <th >CATEGORIE</th>
                     <th >ACTION</th>
                   </tr>
                 </thead>
                 <tbody style="text-align: center">

                    {% for engin in engins %}
                    <tr>
                        <td> {% if engin.engin_image %}<img src="http://127.0.0.1:8000/static{{engin.engin_image.url}}" class="mr-2" alt="Profile Page" width="50px" height="50px" style="border: 1px solid #ddd;">{% endif %} {{engin.matricule}}</td>
                        <td style=" text-align:center;"><span {% if engin.etat == 'DISPONIBLE' %}class="bg-success" {% else %} class="bg-danger" {% endif %}  style="color: white;">{{engin.etat}}</span> </td>
                        <td>{{engin.couleur}}</td>
                        <td>{{engin.type_engins}}</td>
                        <td>
                            <a href="{% url 'engins:edit_car' engin.id %}" class="btn btn-primary btn-sm">VOIR </a>
                        </td>
                      </tr>
                    {% endfor %}
                 </tfoot>
               </table>
             </div>
            </div>
          </div>
        </div>
        <div class="col-lg-6">
            <div class="card">
            <div class="card-body">
              <h4 class="card-title">Missions en cours</h4>
                 <div class="table-responsive">
                  <table id="zero_config" class="table table-striped table-bordered">
              <thead style="text-align: center">
                <tr>
                  <th style="max-width: 100px;">Ordre à </th>
                  <th style="max-width: 100px;">OBJET </th>
                  <th style="max-width: 100px;">ETAT</th>
                  <th style="max-width: 100px;">DATE DEPART</th>
                  <th style="max-width: 100px;">ACTION</th>
                </tr>
              </thead>
              <tbody style="text-align: center">
                {% for mission in missions %}
                <tr {% if mission.date_retour < today and mission.etat_mission == "EN COURS" %} style="background-color: #fce3e3;" {% endif %}  >
                    <td>{{mission.employe.nom}} {{mission.employe.prenom}}</td>
                    <td>{{mission.objet}}</td>
                    <td>{{mission.etat_mission}}</td>
                    <td>{{mission.date_depart | date:'d/m/Y'}}</td>
                    <td>
                        <a href="{% url 'gestions:edit_mission' mission.id %}" class="btn btn-primary btn-sm" >Voir </a>
                    </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            </div>
            </div>
          </div>
        </div>
    </div>

{% endblock %}